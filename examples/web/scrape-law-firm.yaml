# Law Firm Data Extraction Agent
# Extracts comprehensive firm information using ScrapeGraphAI
#
name: law-firm-extractor
description: Extract law firm information from website

state_schema:
  url: str
  result: dict

nodes:
  - name: extract
    uses: web.ai_scrape
    with:
      url: "{{ state.url }}"
      prompt: |
        Extract comprehensive law firm information from this website.
        Look for: firm name, founding year, contact details, partners/lawyers,
        office locations, practice areas, awards, and any available biographical
        information about key personnel. Check the About, Team, Contact, and
        Practice Areas pages if available.
      output_schema:
        type: object
        properties:
          firmName:
            type: string
            description: "Official registered name as shown on website"
          foundedYear:
            type: string
            description: "Year founded (YYYY format) or null"
          website:
            type: string
            description: "Official website URL"
          linkedin:
            type: string
            description: "LinkedIn company page URL or null"
          businessModel:
            type: string
            description: "One of: corporate-firm, boutique-firm, full-service, specialist, virtual, alternative-legal-provider"
          description:
            type: string
            description: "Brief 2-3 sentence description of the firm, its history, and main practice areas"
          country:
            type: string
            description: "ISO 3166-1 alpha-3 country code (e.g., BRA, USA)"
          city:
            type: string
            description: "City where headquarters is located"
          state:
            type: string
            description: "ISO 3166-2 subdivision code (e.g., BR-SP, BR-MG)"
          totalLawyers:
            type: integer
            description: "Approximate total number of lawyers or null"
          totalPartners:
            type: integer
            description: "Approximate number of partners or null"
          mainEmail:
            type: string
            description: "Main contact email from website"
          mainPhone:
            type: string
            description: "Main contact phone from website"
          managingPartners:
            type: array
            items:
              type: object
              properties:
                title:
                  type: string
                  description: "Mr., Ms., Dr., or null"
                firstName:
                  type: string
                  description: "First name"
                surname:
                  type: string
                  description: "Last name / family name"
                email:
                  type: string
                  description: "Professional email or null"
                phone:
                  type: string
                  description: "Direct phone or null"
                role:
                  type: string
                  description: "Specific role (e.g., Managing Partner, Senior Partner)"
                isManagingPartner:
                  type: boolean
                  description: "True if role contains Managing Partner/Director"
                biography:
                  type: string
                  description: "1-2 sentence professional bio (50-100 words)"
                employmentStartDate:
                  type: string
                  description: "YYYY-MM-DD when they joined the firm, or null"
          offices:
            type: array
            items:
              type: object
              properties:
                city:
                  type: string
                  description: "City name"
                state:
                  type: string
                  description: "ISO 3166-2 subdivision code (e.g., BR-MG)"
                country:
                  type: string
                  description: "ISO 3166-1 alpha-3 country code (e.g., BRA)"
                address:
                  type: string
                  description: "Full street address"
                phone:
                  type: string
                  description: "Office phone number"
                isHeadOffice:
                  type: boolean
                  description: "True if this is the headquarters"
          practiceAreas:
            type: array
            items:
              type: string
              description: "Practice area name"
          awards:
            type: array
            items:
              type: string
              description: "Award or ranking"
    output: result

  - name: report
    run: |
      import json
      result = state.get("result", {})

      if result.get("success"):
          data = result.get("data", {}).get("result", result.get("data", {}))
          print("\n" + "="*60)
          print("LAW FIRM EXTRACTION RESULTS")
          print("="*60)
          print(json.dumps(data, indent=2, ensure_ascii=False))
      else:
          print(f"\n[ERROR] {result.get('error')}")

      return {}

edges:
  - from: __start__
    to: extract
  - from: extract
    to: report
  - from: report
    to: __end__
